---
import { getCollection, type CollectionEntry } from 'astro:content';

const works = await getCollection('works') as CollectionEntry<'works'>[];
---

<section>
  <div class="mx-auto max-w-7xl px-6 py-20">

    <!-- Header -->
    <div class="mb-10 flex items-center gap-3">
      <span class="h-3 w-3 rounded-full bg-black"></span>
      <h2>Selected Works</h2>
    </div>

    <div class="border-t border-black">
      {works.map((work) => (
        <a
          href={`/works/${work.slug}`}
          class="group block border-b border-black"
        >
          <!-- BORDER-KÃ–Z -->
          <div class="relative py-24">

            <!-- GRID (DESKTOP META) -->
            <div class="hidden md:grid md:grid-cols-[1fr_2fr] items-center">
              <div>
                <div class="text-sm text-gray-500">
                  [ {work.data.year} ]
                </div>
                <h3 class="mt-2">
                  {work.data.title}
                </h3>
              </div>
              <div />
            </div>

            <!-- TITLE (MOBILE) -->
            <div class="md:hidden">
              <h3>
                {work.data.title}
              </h3>
            </div>

            <!-- RIGHT LAYER (DESKTOP ONLY) -->
            <div class="absolute right-0 inset-y-0 hidden md:flex items-center">

              <!-- SERVICE -->
              <div
                class="
                  text-sm
                  font-medium
                  transition-all
                  duration-300
                  ease-out
                  group-hover:-translate-y-8
                  group-hover:opacity-0
                "
              >
                {work.data.service}
              </div>

              <!-- IMAGE (HOVER) -->
              <div
                class="
                  pointer-events-none
                  absolute
                  right-0
                  opacity-0
                  translate-y-16
                  transition-all
                  duration-300
                  ease-out
                  group-hover:opacity-100
                  group-hover:translate-y-0
                  max-h-full
                  w-[320px]
                "
              >
                <img
                  src={work.data.images[0]}
                  alt={work.data.title}
                  class="max-h-full w-full object-contain"
                />
              </div>

            </div>

            <!-- MOBILE IMAGE -->
            <div class="mt-6 md:hidden">
              <img
                src={work.data.images[0]}
                alt={work.data.title}
                class="w-full rounded-lg object-cover"
              />
            </div>

          </div>
        </a>
      ))}
    </div>

  </div>
</section>
